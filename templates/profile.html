{% extends "base.html" %}

{% block content %}
  <div style="display:flex; flex-direction:column; gap:16px; max-width:720px;">

    <!-- ğŸ”” æé†’ä½¿ç”¨è€…ä¸€å®šè¦è¨˜ä¸‹ user id -->
    <div
      style="
        padding: 10px 12px;
        border-radius: 12px;
        background: #fef2f2;
        border: 1px solid #fecaca;
        color: #b91c1c;
        font-size: 14px;
        line-height: 1.6;
      "
    >
      <strong>âš  è«‹å‹™å¿…è¨˜ä¸‹ä½ çš„ user idï¼š</strong>
      <div
        style="
          margin-top: 4px;
          font-weight: 700;
          font-size: 18px;
          letter-spacing: 0.03em;
        "
      >
        {{ user_id }}
      </div>
      <div style="margin-top: 4px; font-size: 13px; color: #991b1b;">
        å»ºè­°æˆªåœ–æˆ–å¯«ä¸‹ä¾†ï¼Œä¹‹å¾Œæ›é›»è…¦æˆ–é‡æ–°é–‹ç€è¦½å™¨ï¼Œè¦ç™»å…¥åŒä¸€å€‹å¸³è™Ÿæ™‚å°±éœ€è¦é€™çµ„ç·¨è™Ÿã€‚
      </div>
    </div>

    <!-- ä¸ŠåŠéƒ¨ï¼šåŸºæœ¬è³‡æ–™ + ç·¨è¼¯æŒ‰éˆ• -->
    <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:12px;">
      <div>
        <div class="text-muted" style="font-size:13px;">ä½¿ç”¨è€…ç·¨è™Ÿ</div>
        <div style="font-size:15px; font-weight:600; margin-top:2px;">
          {{ user_id }}
        </div>
      </div>

      <a
        href="{{ url_for('profile_edit') }}"
        class="btn btn-primary btn-sm"
        style="text-decoration:none;"
      >
        ç·¨è¼¯å€‹äººè³‡æ–™
      </a>
    </div>

    <div style="display:grid; grid-template-columns:120px 1fr; row-gap:6px; column-gap:12px; font-size:14px;">
      <div class="text-muted">å§“å</div>
      <div>{{ user.name or "ï¼ˆå°šæœªå¡«å¯«ï¼‰" }}</div>

      <div class="text-muted">é€£çµ¡é›»è©±</div>
      <div>{{ user.phone or "ï¼ˆå°šæœªå¡«å¯«ï¼‰" }}</div>

      <div class="text-muted">æ”¶ä»¶åœ°å€</div>
      <div>{{ user.address or "ï¼ˆå°šæœªå¡«å¯«ï¼‰" }}</div>

      <div class="text-muted">å»ºç«‹æ™‚é–“</div>
      <div>{{ user.created_at or "â€”" }}</div>

      {% if user.updated_at %}
        <div class="text-muted">æœ€å¾Œæ›´æ–°</div>
        <div>{{ user.updated_at }}</div>
      {% endif %}
    </div>

    <!-- åˆ†éš”ç·š -->
    <hr style="border:none; border-top:1px solid var(--border); margin:8px 0;" />

    <!-- ä¸‹åŠéƒ¨ï¼šæ­·å²è¨‚å–®åˆ—è¡¨ -->
    <div>
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <div style="font-size:16px; font-weight:600;">æ­·å²è¨‚å–®</div>
        <div class="text-muted" style="font-size:13px;">
          {% if orders and orders|length > 0 %}
            å…± {{ orders|length }} ç­†
          {% else %}
            ç›®å‰å°šç„¡è¨‚å–®
          {% endif %}
        </div>
      </div>

      {% if orders and orders|length > 0 %}
        <table style="width:100%; border-collapse:collapse; font-size:14px;">
          <thead>
            <tr>
              <th style="text-align:left; padding:6px 4px; border-bottom:1px solid var(--border);">è¨‚å–®ç·¨è™Ÿ</th>
              <th style="text-align:left; padding:6px 4px; border-bottom:1px solid var(--border);">æ™‚é–“</th>
              <th style="text-align:right; padding:6px 4px; border-bottom:1px solid var(--border);">é‡‘é¡</th>
              <th style="text-align:center; padding:6px 4px; border-bottom:1px solid var(--border);">å•†å“æ•¸é‡</th>
              <th style="text-align:center; padding:6px 4px; border-bottom:1px solid var(--border);">ç‹€æ…‹</th>
              <th style="text-align:center; padding:6px 4px; border-bottom:1px solid var(--border);"></th>
            </tr>
          </thead>
          <tbody>
            {% for o in orders %}
              <tr>
                <td style="padding:6px 4px;">#{{ o.id }}</td>
                <td style="padding:6px 4px;">{{ o.created_at }}</td>
                <td style="padding:6px 4px; text-align:right;">${{ o.grand_total }}</td>
                <td style="padding:6px 4px; text-align:center;">{{ o.items_count }}</td>
                <td style="padding:6px 4px; text-align:center;">
                  <span class="tag">
                    {{ o.status }}
                  </span>
                </td>
                <td style="padding:6px 4px; text-align:center;">
                  <a
                    href="{{ url_for('order_detail', order_id=o.id) }}"
                    class="btn btn-sm btn-ghost"
                    style="font-size:12px; text-decoration:none;"
                  >
                    æŸ¥çœ‹æ˜ç´°
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <div class="text-muted" style="font-size:14px; margin-top:4px;">
          é‚„æ²’æœ‰ä»»ä½•è¨‚å–®ç´€éŒ„ï¼Œå…ˆå»é€›é€›å•†å“å§ï¼
        </div>
      {% endif %}
    </div>

    <!-- å†åˆ†éš”ç·šä¸€æ¢ -->
    <hr style="border:none; border-top:1px solid var(--border); margin:8px 0;" />

    <!-- âœ… æ¶è³¼æ´»å‹•ç´€éŒ„ -->
    <div>
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <div style="font-size:16px; font-weight:600;">æ¶è³¼æ´»å‹•ç´€éŒ„</div>
        <div class="text-muted" style="font-size:13px;">
          {% if seckill_records and seckill_records|length > 0 %}
            å…± {{ seckill_records|length }} ç­†
          {% else %}
            å°šæœªæœ‰æ¶è³¼æˆåŠŸç´€éŒ„
          {% endif %}
        </div>
      </div>

      {% if seckill_records and seckill_records|length > 0 %}
        <table style="width:100%; border-collapse:collapse; font-size:14px;">
          <thead>
            <tr>
              <th style="text-align:left; padding:6px 4px; border-bottom:1px solid var(--border);">å•†å“ç·¨è™Ÿ</th>
              <th style="text-align:left; padding:6px 4px; border-bottom:1px solid var(--border);">å•†å“åç¨±</th>
              <th style="text-align:left; padding:6px 4px; border-bottom:1px solid var(--border);">æˆåŠŸæ™‚é–“</th>
            </tr>
          </thead>
          <tbody>
            {% for s in seckill_records %}
              <tr>
                <td style="padding:6px 4px;">{{ s.product_id }}</td>
                <td style="padding:6px 4px;">{{ s.product_name }}</td>
                <td style="padding:6px 4px;">{{ s.created_at }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <div class="text-muted" style="font-size:14px; margin-top:4px;">
          æš«æ™‚é‚„æ²’æœ‰æ¶è³¼æˆåŠŸç´€éŒ„ï¼Œå¯ä»¥åˆ°ã€Œæ¶è³¼æ´»å‹•ã€è©¦è©¦æ‰‹æ°£ï¼
        </div>
      {% endif %}
    </div>

    <div style="display:flex; gap:8px; margin-top:4px;">
      <!-- å‰å¾€å•†å“åˆ—è¡¨ -->
      <a
        href="{{ url_for('products') }}"
        class="btn btn-primary btn-sm"
        style="text-decoration:none;"
      >
        å‰å¾€å•†å“åˆ—è¡¨
      </a>

      <!-- å‰å¾€æ¶è³¼æ´»å‹• -->
      <a
        href="{{ url_for('seckill') }}"
        class="btn btn-primary btn-sm"
        style="text-decoration:none;"
      >
        å‰å¾€æ¶è³¼æ´»å‹•
      </a>
    </div>
  </div>
{% endblock %}
