<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <title>{{ title or "Redis Shop" }}</title>
    <style>
      :root {
        --primary: #2563eb;
        --primary-soft: #dbeafe;
        --accent: #f97316;
        --bg: #f3f4f6;
        --card-bg: #ffffff;
        --text-main: #111827;
        --text-sub: #6b7280;
        --border: #e5e7eb;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        margin: 0;
        background: var(--bg);
        color: var(--text-main);
      }

      .layout {
        max-width: 960px;
        margin: 0 auto;
        padding: 20px 16px 40px;
      }

      /* 頂部導覽列 */
      .navbar {
        background: var(--card-bg);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 3px rgba(15, 23, 42, 0.08);
      }

      .navbar-inner {
        max-width: 960px;
        margin: 0 auto;
        padding: 12px 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .brand {
        font-weight: 700;
        font-size: 20px;
        color: var(--primary);
        letter-spacing: 0.03em;
      }

      .nav-links a {
        margin-left: 16px;
        text-decoration: none;
        color: var(--text-sub);
        font-size: 14px;
        padding: 4px 8px;
        border-radius: 999px;
      }

      .nav-links a:hover {
        background: var(--primary-soft);
        color: var(--primary);
      }

      .nav-links a.active {
        background: var(--primary);
        color: #ffffff;
      }

      h1 {
        font-size: 24px;
        margin: 8px 0 16px;
      }

      .page-header {
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }

      .page-header-sub {
        font-size: 14px;
        color: var(--text-sub);
      }

      /* flash 訊息 */
      .flash-wrapper {
        margin-bottom: 12px;
      }

      .flash {
        padding: 8px 10px;
        border-radius: 8px;
        font-size: 14px;
        margin-bottom: 6px;
      }

      .flash-success {
        background: #ecfdf5;
        color: #15803d;
        border: 1px solid #bbf7d0;
      }

      .flash-error {
        background: #fef2f2;
        color: #b91c1c;
        border: 1px solid #fecaca;
      }

      /* 一般卡片容器（內頁主框） */
      .card {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 16px 18px 18px;
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
        border: 1px solid rgba(148, 163, 184, 0.25);
      }

      /* 表格樣式（如果有用到 table） */
      table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 6px;
      }

      th,
      td {
        border-bottom: 1px solid var(--border);
        padding: 8px 6px;
        text-align: left;
        font-size: 14px;
      }

      th {
        font-weight: 600;
        color: var(--text-sub);
        background: #f9fafb;
      }

      tr:last-child td {
        border-bottom: none;
      }

      /* 按鈕與輸入框 */
      .btn {
        border: none;
        border-radius: 999px;
        padding: 6px 14px;
        font-size: 14px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 4px;
      }

      .btn-primary {
        background: var(--primary);
        color: #ffffff;
        white-space: nowrap;      /* ✨ 不允許文字換行 */
        display: inline-flex;     
        align-items: center;
        justify-content: center;
        padding: 6px 16px;        /* 稍微多一點寬度，避免被擠 */
        border-radius: 999px;
        border: none;
        font-size: 14px;
        cursor: pointer;
      } 
      }

      .btn-primary:hover {
        background: #1d4ed8;
      }

      .btn-ghost {
        background: transparent;
        color: var(--text-sub);
      }

      .btn-ghost:hover {
        background: #e5e7eb;
      }

      .btn-sm {
        padding: 4px 10px;
        font-size: 13px;
      }

      input[type="number"] {
        width: 64px;
        padding: 4px 6px;
        border-radius: 999px;
        border: 1px solid var(--border);
        font-size: 13px;
      }

      input[type="number"]:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.4);
      }

      .text-muted {
        color: var(--text-sub);
        font-size: 13px;
      }

      .text-right {
        text-align: right;
      }

      .tag {
        display: inline-flex;
        align-items: center;
        border-radius: 999px;
        border: 1px solid #bfdbfe;
        font-size: 11px;
        padding: 2px 8px;
        color: #1d4ed8;
        background: #eff6ff;
      }

      .pill {
        border-radius: 999px;
        padding: 4px 10px;
        font-size: 12px;
        background: #fee2e2;
        color: #b91c1c;
        display: inline-block;
      }

      @media (max-width: 640px) {
        .navbar-inner {
          flex-direction: column;
          align-items: flex-start;
          gap: 8px;
        }
        .page-header {
          flex-direction: column;
          align-items: flex-start;
        }
        table {
          font-size: 13px;
        }
        th,
        td {
          padding: 6px 4px;
        }
      }

      /* 如果用 table 顯示商品，可以用這些欄寬（目前商品列表沒用也沒關係） */
      .product-table col.col-id    { width: 12%; }
      .product-table col.col-name  { width: 40%; }
      .product-table col.col-price { width: 12%; }
      .product-table col.col-stock { width: 12%; }
      .product-table col.col-action{ width: 24%; }

      /* ================= 商品卡片：一列兩個，左圖右文字 ================= */

      .product-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 20px;
      }

      @media (max-width: 900px) {
        .product-grid {
          grid-template-columns: 1fr;
        }
      }

      .product-card {
        position: relative;
        background: #ffffff;
        border-radius: 16px;
        border: 1px solid rgba(148, 163, 184, 0.35);
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
        overflow: hidden;
        transition: box-shadow 0.2s ease, transform 0.2s ease;
        min-height: 180px;
      }

      .product-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 14px 30px rgba(15, 23, 42, 0.12);
        border-color: rgba(37, 99, 235, 0.45);
      }

      .product-main {
        display: flex;
        align-items: center;
        gap: 26px;
        padding: 18px 22px;
      }

      /* 右上角的小資訊按鈕 */
      .product-info-btn {
        position: absolute;
        top: 10px;
        right: 14px;
        width: 24px;
        height: 24px;
        border-radius: 999px;
        border: none;
        background: #eff6ff;
        color: #1d4ed8;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
      }

      .product-info-btn:hover {
        background: #dbeafe;
      }

      /* 展開詳細資訊時，讓按鈕顏色反轉一下 */
      .product-card.show-extra .product-info-btn {
        background: #1d4ed8;
        color: #ffffff;
      }

      /* 下方詳細資訊區塊，預設隱藏 */
      .product-extra {
        display: none;
        padding: 8px 18px 12px;
        border-top: 1px solid #e5e7eb;
        font-size: 13px;
        color: #4b5563;
      }

      /* 卡片被加上 .show-extra 時，就顯示詳細資訊 */
      .product-card.show-extra .product-extra {
        display: block;
      }

      .product-extra-row {
        display: flex;
        gap: 4px;
        margin: 2px 0;
      }

      .product-extra-note {
        margin-top: 4px;
        color: #6b7280;
        font-size: 12px;
      }

      .product-thumb {
        width: 140px;
        flex-shrink: 0;
        border-radius: 14px;
        overflow: hidden;
        background: #f9fafb;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .product-thumb img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .product-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      .product-title {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 1px;
      }

      .product-meta-row {
        display: flex;
        align-items: center;
        gap: 18px;               /* 編號與庫存的間距 */
        margin-top: 1px;
        font-size: 13px;
        color: #6b7280;
      }

      .product-bottom {
        margin-top: 10px;
        display: flex;
        flex-direction: column;   /* 改成上下排列 */
        align-items: flex-start;  /* 靠左對齊 */
        gap: 15px;                 /* 上下間距 */
      }


      .product-price {
        font-weight: 700;
        font-size: 16px;
        white-space: nowrap;
        display: inline-flex;
        align-items: baseline;
      }

      .product-price span {
        font-size: 12px;
        color: #6b7280;
        margin-left: 2px;
      }


      /* 數量 + 按鈕 */
      .product-actions {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .product-actions input[type="number"] {
        width: 64px;
      }

      .product-bottom input[type="number"] {
        width: 70px;
      }

      /* ================= 購物車版面 ================= */

      .cart-layout {
        display: grid;
        grid-template-columns: minmax(0, 2fr) minmax(260px, 1fr);
        gap: 16px;
      }

      .cart-summary-card {
        background: #ffffff;
        border-radius: 16px;
        padding: 14px 16px;
        border: 1px solid rgba(148, 163, 184, 0.45);
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
        position: sticky;
        top: 80px;
        align-self: flex-start;
      }

      @media (max-width: 768px) {
        .cart-layout {
          grid-template-columns: 1fr;
        }
        .cart-summary-card {
          position: static;
        }
      }

      /* ================= 秒殺活動 ================= */

      .seckill-grid {
        display: grid;
        grid-template-columns: minmax(0, 1fr);
        gap: 12px;
      }

      .seckill-card {
        background: #ffffff;
        border-radius: 16px;
        padding: 14px 16px;
        border: 1px solid rgba(248, 113, 113, 0.4);
        box-shadow: 0 10px 25px rgba(248, 113, 113, 0.12);
      }

      .badge-status {
        display: inline-flex;
        align-items: center;
        padding: 2px 8px;
        font-size: 11px;
        border-radius: 999px;
        font-weight: 500;
      }
      .badge-open {
        background: #dcfce7;
        color: #166534;
      }
      .badge-notyet {
        background: #fef9c3;
        color: #854d0e;
      }
      .badge-end {
        background: #fee2e2;
        color: #b91c1c;
      }

      .seckill-progress {
        margin-top: 6px;
        margin-bottom: 2px;
      }

      .seckill-progress-bar {
        width: 100%;
        height: 8px;
        border-radius: 999px;
        background: #f3f4f6;
        overflow: hidden;
        margin-bottom: 4px;
      }

      .seckill-progress-inner {
        height: 100%;
        background: linear-gradient(to right, #fb923c, #f97316);
      }
    </style>
  </head>
  <body>
    <header class="navbar">
      <div class="navbar-inner">
        <div class="brand">Redis Shop</div>
        <div class="nav-links">
          <a
            href="{{ url_for('products') }}"
            class="{% if request.endpoint == 'products' %}active{% endif %}"
            >商品列表</a
          >
          <a
            href="{{ url_for('cart') }}"
            class="{% if request.endpoint == 'cart' %}active{% endif %}"
            >購物車</a
          >
          <a
            href="{{ url_for('seckill') }}"
            class="{% if request.endpoint == 'seckill' %}active{% endif %}"
            >秒殺活動</a
          >
        </div>
      </div>
    </header>

    <main class="layout">
      <div class="page-header">
        <div>
          <h1>{{ title or "Redis Shop" }}</h1>
          {% if subtitle %}
          <div class="page-header-sub">{{ subtitle }}</div>
          {% endif %}
        </div>
      </div>

      <div class="flash-wrapper">
        {% with messages = get_flashed_messages(with_categories=True) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="flash flash-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}
      </div>

      <div class="card">
        {% block content %}{% endblock %}
      </div>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".product-info-toggle").forEach((btn) => {
          btn.addEventListener("click", () => {
            const card = btn.closest(".product-card");
            if (!card) return;
            card.classList.toggle("show-extra");
          });
        });
      });
    </script>
  </body>
</html>
